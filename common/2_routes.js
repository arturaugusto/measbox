// Routes
Router.route('/:_id', {
  template: 'showSpreadsheet',
  waitOn: function () {
    var that = this;
    this.spreadsheetId = this.params._id;
    return [
      Meteor.subscribe('currentSpreadsheet', this.spreadsheetId)
    ];
  },
  data: function () {
    var item = Spreadsheets.findOne( { _id: this.params._id } );
    return item;
  }
});

Router.route('/', {
  template: 'showSpreadsheet',
  waitOn: function () {
    var that = this;
    // data was encoded with:
    //utoa(JSON.stringify(Spreadsheets.findOne()));
    var data = "eyJfaWQiOiJCZ2ttRE5zdUdpN0ZnRU1BSCIsImluc3RydW1lbnRzIjpbeyJfaWQiOiJzTTRUZzR0NktQSGo3cGFpeCIsIm5hbWUiOiJGbHVrZSIsInVuaXQiOiJWIiwia2luZCI6Ik1ldGVyIiwicmFuZ2VzIjpbeyJsaW1pdHMiOnsic3RhcnQiOjAsImVuZCI6MTAsImZ1bGxzY2FsZSI6MTAsImF1dG9yYW5nZUNvbmRpdGlvbnMiOiIoKHJlYWRvdXQgPj0gcmFuZ2VTdGFydCkgYW5kIChyZWFkb3V0IDw9IHJhbmdlRW5kKSkgb3IgaXNGaXhlZCIsInJlc29sdXRpb24iOiIwLjAwMSJ9LCJub21pbmFsVmFsdWUiOiJyZWFkb3V0ID0gaXNGaXhlZCA/IDAgOiByZWFkb3V0IiwidW5jZXJ0YWludGllcyI6W3sibmFtZSI6IlJlc29sdXRpb24iLCJkZXNjcmlwdGlvbiI6IkhhbGYgb2YgbWluaW11bSBzdGVwIHNpemUiLCJkaXN0cmlidXRpb24iOiJ1bmlmb3JtIiwiZm9ybXVsYSI6InUgPSByZXNvbHV0aW9uIC8gMiJ9LHsibmFtZSI6Ik1QRSIsImRlc2NyaXB0aW9uIjoiTWF4aW11bSBQZXJtaXNzaWJsZSBFcnJvciIsImRpc3RyaWJ1dGlvbiI6InVuaWZvcm0iLCJmb3JtdWxhIjoibXBlID0gMC4wMDUgKiByZWFkb3V0In1dLCJfaWQiOiJoYmpMazR5bUFhZWJyMzRmQSJ9LHsibGltaXRzIjp7InN0YXJ0IjowLCJlbmQiOjEwMCwiZnVsbHNjYWxlIjoxMDAsImF1dG9yYW5nZUNvbmRpdGlvbnMiOiIoKHJlYWRvdXQgPj0gcmFuZ2VTdGFydCkgYW5kIChyZWFkb3V0IDw9IHJhbmdlRW5kKSkgb3IgaXNGaXhlZCIsInJlc29sdXRpb24iOiIwLjAwMSJ9LCJub21pbmFsVmFsdWUiOiJyZWFkb3V0ID0gaXNGaXhlZCA/IDAgOiByZWFkb3V0IiwidW5jZXJ0YWludGllcyI6W3sibmFtZSI6IlJlc29sdXRpb24iLCJkZXNjcmlwdGlvbiI6IkhhbGYgb2YgbWluaW11bSBzdGVwIHNpemUiLCJkaXN0cmlidXRpb24iOiJ1bmlmb3JtIiwiZm9ybXVsYSI6InUgPSByZXNvbHV0aW9uIC8gMiJ9LHsibmFtZSI6Ik1QRSIsImRlc2NyaXB0aW9uIjoiTWF4aW11bSBQZXJtaXNzaWJsZSBFcnJvciIsImRpc3RyaWJ1dGlvbiI6InVuaWZvcm0iLCJmb3JtdWxhIjoibXBlID0gMC4wMDUgKiByZWFkb3V0In1dLCJfaWQiOiJyU3JoaDVyVG9lelRKUnlQZSJ9XSwiYXV0b21hdGlvbiI6eyJjb2RlIjoiQEZlYXQoTm9uZSlcbmRlZiByZWFkb3V0KHNlbGYpOlxuICAgIHJldHVybiAoc2VsZi5xdWVyeSgnT1VUPycpKVxuXG5AcmVhZG91dC5zZXR0ZXJcbmRlZiByZWFkb3V0KHNlbGYsIHZhbHVlKTpcbiBzZWxmLndyaXRlKCdPVVQgezouOGZ9IFYnLmZvcm1hdCh2YWx1ZSkpIn19LHsiX2lkIjoiNXRzYXhuR0I0U2tIbUNCemYiLCJuYW1lIjoiODdWIiwidW5pdCI6IlYiLCJraW5kIjoiTWV0ZXIiLCJyYW5nZXMiOlt7ImxpbWl0cyI6eyJzdGFydCI6MCwiZW5kIjoxMCwiZnVsbHNjYWxlIjoxMCwiYXV0b3JhbmdlQ29uZGl0aW9ucyI6IigocmVhZG91dCA+PSByYW5nZVN0YXJ0KSBhbmQgKHJlYWRvdXQgPD0gcmFuZ2VFbmQpKSBvciBpc0ZpeGVkIiwicmVzb2x1dGlvbiI6IjAuMSJ9LCJub21pbmFsVmFsdWUiOiJyZWFkb3V0ID0gaXNGaXhlZCA/IDAgOiByZWFkb3V0IiwidW5jZXJ0YWludGllcyI6W3sibmFtZSI6IlJlc29sdXRpb24iLCJkZXNjcmlwdGlvbiI6IkhhbGYgb2YgbWluaW11bSBzdGVwIHNpemUiLCJkaXN0cmlidXRpb24iOiJ1bmlmb3JtIiwiZm9ybXVsYSI6InUgPSByZXNvbHV0aW9uIC8gMiJ9LHsibmFtZSI6Ik1QRSIsImRlc2NyaXB0aW9uIjoiTWF4aW11bSBQZXJtaXNzaWJsZSBFcnJvciIsImRpc3RyaWJ1dGlvbiI6InVuaWZvcm0iLCJmb3JtdWxhIjoibXBlID0gMC4wNSAqIHJlYWRvdXQifV0sIl9pZCI6Im02QTQzZG1zcmhQM0JFRjNiIn0seyJsaW1pdHMiOnsic3RhcnQiOjAsImVuZCI6MTAwLCJmdWxsc2NhbGUiOjEwMCwiYXV0b3JhbmdlQ29uZGl0aW9ucyI6IigocmVhZG91dCA+PSByYW5nZVN0YXJ0KSBhbmQgKHJlYWRvdXQgPD0gcmFuZ2VFbmQpKSBvciBpc0ZpeGVkIiwicmVzb2x1dGlvbiI6IjAuMDEifSwibm9taW5hbFZhbHVlIjoicmVhZG91dCA9IGlzRml4ZWQgPyAwIDogcmVhZG91dCIsInVuY2VydGFpbnRpZXMiOlt7Im5hbWUiOiJSZXNvbHV0aW9uIiwiZGVzY3JpcHRpb24iOiJIYWxmIG9mIG1pbmltdW0gc3RlcCBzaXplIiwiZGlzdHJpYnV0aW9uIjoidW5pZm9ybSIsImZvcm11bGEiOiJ1ID0gcmVzb2x1dGlvbiAvIDIifSx7Im5hbWUiOiJNUEUiLCJkZXNjcmlwdGlvbiI6Ik1heGltdW0gUGVybWlzc2libGUgRXJyb3IiLCJkaXN0cmlidXRpb24iOiJ1bmlmb3JtIiwiZm9ybXVsYSI6Im1wZSA9IDAuMDA1ICogcmVhZG91dCJ9XSwiX2lkIjoiNnFmYXhTa2RjM25Rc0N1ekQifV0sImF1dG9tYXRpb24iOnsiY29kZSI6IkBGZWF0KE5vbmUpXG5kZWYgcmVhZG91dChzZWxmKTpcbiAgICByZXR1cm4gKHNlbGYucXVlcnkoJ09VVD8nKSlcblxuQHJlYWRvdXQuc2V0dGVyXG5kZWYgcmVhZG91dChzZWxmLCB2YWx1ZSk6XG4gc2VsZi53cml0ZSgnT1VUIHs6LjhmfSBWJy5mb3JtYXQodmFsdWUpKSJ9fV0sIm51bGwiOiIiLCJwcm9jZWR1cmVzIjpbeyJfaWQiOiIxNDU4NTIwNjQ1MDA0IiwiZnVuY3Rpb25hbGl0eVRhZ3MiOlsiVm9sdGFnZSBDYWxpYnJhdGlvbiB3aXRoIGRpdmlzb3IiLCJEQ1YiXSwidmFyaWFibGVzIjpbeyJuYW1lIjoiVVVUIiwiY29sb3IiOiIjZDFlM2ZmIiwia2luZCI6IlJlYWRvdXQifSx7Im5hbWUiOiJSZWYiLCJjb2xvciI6IiNmZmY4YzAiLCJraW5kIjoiUmVhZG91dCJ9LHsibmFtZSI6InRlc3RlIiwiY29sb3IiOiIjZmZmZmZmIiwia2luZCI6IkluZmx1ZW5jZSJ9XSwibiI6NCwiZnVuYyI6IlVVVCAtIFJlZiIsImFkZGl0aW9uYWxPcHRpb25zIjp7ImNsIjowLjk1MywiYXV0b21hdGlvbiI6IiIsInBvc3RQcm9jZXNzaW5nIjoia0ZtdCAgICAgICAgICAgID0gZm10VG9GaXhlZChrLCAyKVxudXV0UHJlZml4VmFsICAgID0gcHJlZml4VmFsKHV1dFByZWZpeClcblVGbXQgICAgICAgICAgICA9IGZtdFRvUHJlY2lzaW9uKFUgLyB1dXRQcmVmaXhWYWwsIDIpXG5VUHJlYyAgICAgICAgICAgPSBkZWNpbWFsUGxhY2VzKFVGbXQpXG51dXRSZWFkb3V0Rm10ICAgPSBmbXRUb0ZpeGVkKHV1dFJlYWRvdXQgLyB1dXRQcmVmaXhWYWwsIGRlY2ltYWxQbGFjZXModXV0UmVzb2x1dGlvbiAvIHV1dFByZWZpeFZhbCkgKVxuY29ycmVjdFZhbHVlRm10ID0gZm10VG9GaXhlZChjb3JyZWN0VmFsdWUgLyB1dXRQcmVmaXhWYWwsIFVQcmVjKVxuZXJyRm10ICAgICAgICAgID0gZm10VG9GaXhlZCh5IC8gdXV0UHJlZml4VmFsLCBVUHJlYylcbm1wZUZtdCAgICAgICAgICA9IGZtdFRvRml4ZWQobXBlIC8gdXV0UHJlZml4VmFsLCBVUHJlYylcbnR1ciAgICAgICAgICAgICA9IGZtdFRvRml4ZWQobXBlL1UsIDIpXG52ZWZmRm10ICAgICAgICAgPSB2ZWZmID4gOTk5OSA/IFwi4oieXCIgOiByb3VuZCh2ZWZmKSIsInJlc3VsdHNUZW1wbGF0ZSI6IlBhcmFtZXRlciAgICAgICAgICAgfCBWYWx1ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG46LS0tLS0tLS0tLS0tLS0tOiAgIHw6LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS06XG5SZWZlcmVuY2UgICAgICAgICAgIHwgPCU9Y29ycmVjdFZhbHVlRm10JT4gPCU9dXV0UHJlZml4JT48JT11dXRVbml0JT4gIFxuVSAgICAgICAgICAgICAgICAgICB8IDwlPVVGbXQlPiA8JT11dXRQcmVmaXglPjwlPXV1dFVuaXQlPiAgICAgICAgICAgICBcbjwlPXV1dE5hbWUlPiAgICAgICAgfCA8JT11dXRSZWFkb3V0Rm10JT4gPCU9dXV0UHJlZml4JT48JT11dXRVbml0JT4gICAgXG5NUEUgICAgICAgICAgICAgICAgIHwgPCU9bXBlRm10JT4gPCU9dXV0UHJlZml4JT48JT11dXRVbml0JT4gICAgICAgICAgIFxuRXJyb3IgICAgICAgICAgICAgICB8IDwlPWVyckZtdCU+IDwlPXV1dFByZWZpeCU+PCU9dXV0VW5pdCU+ICBcblRVUiAgICAgICAgICAgICAgICAgfCA8JT10dXIlPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5rICAgICAgICAgICAgICAgICAgIHwgPCU9a0ZtdCU+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuX3ZfPHN1Yj5lZmY8L3N1Yj4gICB8IDwlPXZlZmZGbXQlPiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblxuXG5cbiJ9fV0sIndvcmtzaGVldHMiOlt7InJvd3MiOltdLCJfaWQiOiJNdTJwU202c3dBYXJwUWJDWCJ9XX0=";
    // decode data:
    var item = JSON.parse(atou(data));
    this.spreadsheetId = this.params._id;
    return [
      Meteor.subscribe('currentSpreadsheet', this.spreadsheetId)
    ];
  },
  data: function () {
    var item = Spreadsheets.findOne( { _id: this.params._id } );
    return item;
  }
});

